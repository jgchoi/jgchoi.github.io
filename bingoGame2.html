<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Web App</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <style>
        #wheelOfFortune {
  display: inline-flex;
  position: relative;
  overflow: hidden;
}

#wheel {
  display: block;
}

#spin {
  font: 20rem/0 sans-serif;
  user-select: none;
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: center;
  position: absolute;
  top: 50%;
  left: 50%;
  width: 70%;
  height: 70%;
  margin: -35%;
  background: #fff;
  color: #000;
  box-shadow: 0 0 0 8px currentColor, 0 0px 15px 5px rgba(0, 0, 0, 0.6);
  border-radius: 50%;
  transition: 0.8s;
}

#spin::after {
  content: "";
  position: absolute;
  top: -35px;
  border: 31px solid transparent;
  border-bottom-color: currentColor;
  border-top: none;
}
    </style>
</head>
<body>
    <div>
        <div class="row">
          <h1>하상회 빙고</h1>
          </div>
       
       <div class="row">
        <div class="col">
            <div id="wheelOfFortune">
                <canvas id="wheel" width="700" height="700"></canvas>
                <div id="spin">00</div>
        </div>
        </div> 
        <div class="col">
            <!-- table showing bingo result, 5 row with B I N G O ant first colddumn, and rest will be numbers-->
            <!-- table id table, content center, fill space-->
            <table id="table" class="table align-middle">
                <tr>
                    <td><b>B</b></td>
                    <td>
                    <button disabled id="btn-1" type="button" class="btn btn-secondary btn-sm">01</button>
                    <button disabled id="btn-2" type="button" class="btn btn-secondary btn-sm">02</button>
                    <button disabled id="btn-3" type="button" class="btn btn-secondary btn-sm">03</button>
                    <button disabled id="btn-4" type="button" class="btn btn-secondary btn-sm">04</button>
                    <button disabled id="btn-5" type="button" class="btn btn-secondary btn-sm">05</button>
                    <button disabled id="btn-6" type="button" class="btn btn-secondary btn-sm">06</button>
                    <button disabled id="btn-7" type="button" class="btn btn-secondary btn-sm">07</button>
                    <button disabled id="btn-8" type="button" class="btn btn-secondary btn-sm">08</button>
                    <button disabled id="btn-9" type="button" class="btn btn-secondary btn-sm">09</button>
                    <button disabled id="btn-10" type="button" class="btn btn-secondary btn-sm">10</button>
                    <button disabled id="btn-11" type="button" class="btn btn-secondary btn-sm">11</button>
                    <button disabled id="btn-12" type="button" class="btn btn-secondary btn-sm">12</button>
                    <button disabled id="btn-13" type="button" class="btn btn-secondary btn-sm">13</button>
                    <button disabled id="btn-14" type="button" class="btn btn-secondary btn-sm">14</button>
                    <button disabled id="btn-15" type="button" class="btn btn-secondary btn-sm">15</button>
                    </td>
                    
                </tr>
                <tr>
                    <td><b>I</b></td>
                    <td>
                    <button disabled id="btn-16" type="button" class="btn btn-secondary btn-sm">16</button>
                    <button disabled id="btn-17" type="button" class="btn btn-secondary btn-sm">17</button>
                    <button disabled id="btn-18" type="button" class="btn btn-secondary btn-sm">18</button>
                    <button disabled id="btn-19" type="button" class="btn btn-secondary btn-sm">19</button>
                    <button disabled id="btn-20" type="button" class="btn btn-secondary btn-sm">20</button>
                    <button disabled id="btn-21" type="button" class="btn btn-secondary btn-sm">21</button>
                    <button disabled id="btn-22" type="button" class="btn btn-secondary btn-sm">22</button>
                    <button disabled id="btn-23" type="button" class="btn btn-secondary btn-sm">23</button>
                    <button disabled id="btn-24" type="button" class="btn btn-secondary btn-sm">24</button>
                    <button disabled id="btn-25" type="button" class="btn btn-secondary btn-sm">25</button>
                    <button disabled id="btn-26" type="button" class="btn btn-secondary btn-sm">26</button>
                    <button disabled id="btn-27" type="button" class="btn btn-secondary btn-sm">27</button>
                    <button disabled id="btn-28" type="button" class="btn btn-secondary btn-sm">28</button>
                    <button disabled id="btn-29" type="button" class="btn btn-secondary btn-sm">29</button>
                    <button disabled id="btn-30" type="button" class="btn btn-secondary btn-sm">30</button></td>

                </tr>
                <tr>
                    <td><b>N</b></td>
                    <td>
                        
                    <!-- 31 to 45-->
                    <button disabled id="btn-31" type="button" class="btn btn-secondary btn-sm">31</button>
                    <button disabled id="btn-32" type="button" class="btn btn-secondary btn-sm">32</button>
                    <button disabled id="btn-33" type="button" class="btn btn-secondary btn-sm">33</button>
                    <button disabled id="btn-34" type="button" class="btn btn-secondary btn-sm">34</button>
                    <button disabled id="btn-35" type="button" class="btn btn-secondary btn-sm">35</button>
                    <button disabled id="btn-36" type="button" class="btn btn-secondary btn-sm">36</button>
                    <button disabled id="btn-37" type="button" class="btn btn-secondary btn-sm">37</button>
                    <button disabled id="btn-38" type="button" class="btn btn-secondary btn-sm">38</button>
                    <button disabled id="btn-39" type="button" class="btn btn-secondary btn-sm">39</button>
                    <button disabled id="btn-40" type="button" class="btn btn-secondary btn-sm">40</button>
                    <button disabled id="btn-41" type="button" class="btn btn-secondary btn-sm">41</button>
                    <button disabled id="btn-42" type="button" class="btn btn-secondary btn-sm">42</button>
                    <button disabled id="btn-43" type="button" class="btn btn-secondary btn-sm">43</button>
                    <button disabled id="btn-44" type="button" class="btn btn-secondary btn-sm">44</button>
                    <button disabled id="btn-45" type="button" class="btn btn-secondary btn-sm">45</button></td>
                </tr>
                <tr>
                    <td><b>G</b></td>
                    <td>

                        
                    <!-- 46 to 60-->
                    <button  disabled id="btn-46" type="button" class="btn btn-secondary btn-sm">46</button>
                    <button  disabled id="btn-47" type="button" class="btn btn-secondary btn-sm">47</button>
                    <button  disabled id="btn-48" type="button" class="btn btn-secondary btn-sm">48</button>
                    <button  disabled id="btn-49" type="button" class="btn btn-secondary btn-sm">49</button>
                    <button  disabled id="btn-50" type="button" class="btn btn-secondary btn-sm">50</button>
                    <button  disabled id="btn-51" type="button" class="btn btn-secondary btn-sm">51</button>
                    <button  disabled id="btn-52" type="button" class="btn btn-secondary btn-sm">52</button>
                    <button  disabled id="btn-53" type="button" class="btn btn-secondary btn-sm">53</button>
                    <button  disabled id="btn-54" type="button" class="btn btn-secondary btn-sm">54</button>
                    <button  disabled id="btn-55" type="button" class="btn btn-secondary btn-sm">55</button>
                    <button  disabled id="btn-56" type="button" class="btn btn-secondary btn-sm">56</button>
                    <button  disabled id="btn-57" type="button" class="btn btn-secondary btn-sm">57</button>
                    <button  disabled id="btn-58" type="button" class="btn btn-secondary btn-sm">58</button>
                    <button  disabled id="btn-59" type="button" class="btn btn-secondary btn-sm">59</button>
                    <button  disabled id="btn-60" type="button" class="btn btn-secondary btn-sm">60</button>
                    </td>
                </tr>
                <tr>
                    <td><b>O</b></td>
                    <td>
                    <!-- 61 to 75-->
                    <button disabled id="btn-61" type="button" class="btn btn-secondary btn-sm">61</button>
                    <button disabled id="btn-62" type="button" class="btn btn-secondary btn-sm">62</button>
                    <button disabled id="btn-63" type="button" class="btn btn-secondary btn-sm">63</button>
                    <button disabled id="btn-64" type="button" class="btn btn-secondary btn-sm">64</button>
                    <button disabled id="btn-65" type="button" class="btn btn-secondary btn-sm">65</button>
                    <button disabled id="btn-66" type="button" class="btn btn-secondary btn-sm">66</button>
                    <button disabled id="btn-67" type="button" class="btn btn-secondary btn-sm">67</button>
                    <button disabled id="btn-68" type="button" class="btn btn-secondary btn-sm">68</button>
                    <button disabled id="btn-69" type="button" class="btn btn-secondary btn-sm">69</button>
                    <button disabled id="btn-70" type="button" class="btn btn-secondary btn-sm">70</button>
                    <button disabled id="btn-71" type="button" class="btn btn-secondary btn-sm">71</button>
                    <button disabled id="btn-72" type="button" class="btn btn-secondary btn-sm">72</button>
                    <button disabled id="btn-73" type="button" class="btn btn-secondary btn-sm">73</button>
                    <button disabled id="btn-74" type="button" class="btn btn-secondary btn-sm">74</button>
                    <button disabled id="btn-75" type="button" class="btn btn-secondary btn-sm">75</button>
                    </td>
                </tr>

        </div>
       </div>
       
      </div>
      </div>
    
</body>
</html>

<script>
    var lastSelectedNumber = 0;
    // create array of number 1 to 75
const numbers = Array.from({length: 75}, (_, i) => i + 1);
// mix numbers
numbers.sort(() => Math.random() - 0.5);
// create sectors with random color and label
const sectors = numbers.map((n, i) => ({
    color: `hsl(${i * 360 / 75}, 70%, 80%)`,
    label: n
}));

// Generate random float in range min-max:
const rand = (m, M) => Math.random() * (M - m) + m;
var tot = sectors.length;
const elSpin = document.querySelector("#spin");
const ctx = document.querySelector("#wheel").getContext`2d`;
const dia = ctx.canvas.width;
const rad = dia / 2;
const PI = Math.PI;
const TAU = 2 * PI;
var arc = TAU / tot;
const friction = 0.991;  // 0.995=soft, 0.99=mid, 0.98=hard
var angVelMin = 0.002; // Below that number will be treated as a stop
// const angVelMin = 10.1; // Below that number will be treated as a stop
let angVelMax = 0; // Random ang.vel. to accelerate to 
let angVel = 0;    // Current angular velocity
let ang = 0;       // Angle rotation in radians
let isSpinning = false;
let isAccelerating = false;
let animFrame = null; // Engine's requestAnimationFrame

//* Get index of current sector */
var getIndex = () => Math.floor(tot - ang / TAU * tot) % tot;

//* Draw sectors and prizes texts to canvas */
const drawSector = (sector, i) => {
  const ang = arc * i;
  ctx.save();
  // COLOR
  ctx.beginPath();
  ctx.fillStyle = sector.color;
  ctx.moveTo(rad, rad);
  ctx.arc(rad, rad, rad, ang, ang + arc);
  ctx.lineTo(rad, rad);
  ctx.fill();
  // TEXT
  ctx.translate(rad, rad);
  ctx.rotate(ang + arc / 2);
  ctx.textAlign = "right";
  ctx.fillStyle = "#000";
  ctx.font = "bold 30px sans-serif";
  ctx.fillText(sector.label, rad - 10, 10);
  //
  ctx.restore();
};

//* CSS rotate CANVAS Element */
const rotate = () => {
  const sector = sectors[getIndex()];
  ctx.canvas.style.transform = `rotate(${ang - PI / 2}rad)`;
  elSpin.textContent = sector.label;
  elSpin.style.background = sector.color;

  if (angVel == 0) {
    // Set lastSelectedNumber
    lastSelectedNumber = sector.label;
    


    // Mark selected number enabled, set btn-primary
    // removed disabled
    document.getElementById("btn-" + lastSelectedNumber).disabled = false;
    document.getElementById("btn-" + lastSelectedNumber).classList.remove("btn-secondary");
    document.getElementById("btn-" + lastSelectedNumber).classList.add("btn-primary");
  }
};

const frame = () => {

  if (!isSpinning) return;

  if (angVel >= angVelMax) isAccelerating = false;

  // Accelerate
  if (isAccelerating) {
    angVel ||= angVelMin; // Initial velocity kick
    angVel *= 1.06; // Accelerate
  }
  
  // Decelerate
  else {
    isAccelerating = false;
    angVel *= friction; // Decelerate by friction  

    // SPIN END:
    if (angVel < angVelMin) {
      isSpinning = false;
      angVel = 0;
      cancelAnimationFrame(animFrame);
    }
  }

  ang += angVel; // Update angle
  ang %= TAU;    // Normalize angle
  rotate();      // CSS rotate!
};

const engine = () => {
  frame();
  animFrame = requestAnimationFrame(engine)
};

elSpin.addEventListener("click", () => {
  if (isSpinning) return;
  if (lastSelectedNumber != 0) {
 // Remove selected sector
 sectors.splice(getIndex(), 1);

// remove all sectors
ctx.clearRect(0, 0, dia, dia);
tot = sectors.length;
arc = TAU / tot;
// Draw remaining sectors
sectors.forEach(drawSector);
  }
 

  isSpinning = true;
  isAccelerating = true;
  angVelMax = rand(0.25, 0.40);
  angVelMin = rand(0.0005, 0.002)
  engine(); // Start engine!
});

// INIT!
sectors.forEach(drawSector);
// rotate(); // Initial rotation
</script>