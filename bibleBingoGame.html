<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Web App</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <style>
        #wheelOfFortune {
  display: inline-flex;
  position: relative;
  overflow: hidden;
}

#wheel {
  display: block;
}

#spin {
  font: 1.5rem/0 sans-serif;
  user-select: none;
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: center;
  position: absolute;
  top: 50%;
  left: 50%;
  width: 30%;
  overflow-wrap: break-word;
  height: 30%;
  margin: -15%;
  background: #fff;
  color: #000;
  box-shadow: 0 0 0 8px currentColor, 0 0px 15px 5px rgba(0, 0, 0, 0.6);
  border-radius: 50%;
  transition: 0.8s;
}

#spin::after {
  content: "";
  position: absolute;
  top: -17px;
  border: 10px solid transparent;
  border-bottom-color: currentColor;
  border-top: none;
}
    </style>
</head>
<body>
    <div>
       <h1>성경 빙고</h1>
       <div class="row">
        <div class="col-5">
            <div id="wheelOfFortune">
                <canvas id="wheel" width="700" height="700"></canvas>
                <div id="spin">00</div>
        </div>
        </div>
        <div class="col-5">

            <button disabled id="btn-1" type="button" class="btn btn-secondary mb-1">창세기</button>
            <button disabled id="btn-2" type="button" class="btn btn-secondary mb-1">탈출기</button>
            <button disabled id="btn-3" type="button" class="btn btn-secondary mb-1">레위기</button>
            <button disabled id="btn-4" type="button" class="btn btn-secondary mb-1">민수기</button>
            <button disabled id="btn-5" type="button" class="btn btn-secondary mb-1">신명기</button>
            <button disabled id="btn-6" type="button" class="btn btn-secondary mb-1">여호수아기</button>
            <button disabled id="btn-7" type="button" class="btn btn-secondary mb-1">판관기</button>
            <button disabled id="btn-8" type="button" class="btn btn-secondary mb-1">룻기</button>
            <button disabled id="btn-9" type="button" class="btn btn-secondary mb-1">사무엘기 상권</button>
            <button disabled id="btn-10" type="button" class="btn btn-secondary mb-1">사무엘기 하권</button>
            <button disabled id="btn-11" type="button" class="btn btn-secondary mb-1">열왕기 상권</button>
            <button disabled id="btn-12" type="button" class="btn btn-secondary mb-1">열왕기 하권</button>
            <button disabled id="btn-13" type="button" class="btn btn-secondary mb-1">역대기 상권</button>
            <button disabled id="btn-14" type="button" class="btn btn-secondary mb-1">역대기 하권</button>
            <button disabled id="btn-15" type="button" class="btn btn-secondary mb-1">에즈라기</button>
            <button disabled id="btn-16" type="button" class="btn btn-secondary mb-1">느헤미야기</button>
            <button disabled id="btn-17" type="button" class="btn btn-secondary mb-1">토빗기</button>
            <button disabled id="btn-18" type="button" class="btn btn-secondary mb-1">유딧기</button>
            <button disabled id="btn-19" type="button" class="btn btn-secondary mb-1">에스테르기</button>
            <button disabled id="btn-20" type="button" class="btn btn-secondary mb-1">마카베오기 상권</button>
            <button disabled id="btn-21" type="button" class="btn btn-secondary mb-1">마카베오기 하권</button>
            <button disabled id="btn-22" type="button" class="btn btn-secondary mb-1">욥기</button>
            <button disabled id="btn-23" type="button" class="btn btn-secondary mb-1">시편</button>
            <button disabled id="btn-24" type="button" class="btn btn-secondary mb-1">잠언</button>
            <button disabled id="btn-25" type="button" class="btn btn-secondary mb-1">코헬렛</button>
            <button disabled id="btn-26" type="button" class="btn btn-secondary mb-1">아가</button>
            <button disabled id="btn-27" type="button" class="btn btn-secondary mb-1">지혜서</button>
            <button disabled id="btn-28" type="button" class="btn btn-secondary mb-1">집회서</button>
            <button disabled id="btn-29" type="button" class="btn btn-secondary mb-1">이사야서</button>
            <button disabled id="btn-30" type="button" class="btn btn-secondary mb-1">예레미야서</button>
            <button disabled id="btn-31" type="button" class="btn btn-secondary mb-1">애가</button>
            <button disabled id="btn-32" type="button" class="btn btn-secondary mb-1">바룩서</button>
            <button disabled id="btn-33" type="button" class="btn btn-secondary mb-1">에제키엘서</button>
            <button disabled id="btn-34" type="button" class="btn btn-secondary mb-1">다니엘서</button>
            <button disabled id="btn-35" type="button" class="btn btn-secondary mb-1">호세아서</button>
            <button disabled id="btn-36" type="button" class="btn btn-secondary mb-1">요엘서</button>
            <button disabled id="btn-37" type="button" class="btn btn-secondary mb-1">아모스서</button>
            <button disabled id="btn-38" type="button" class="btn btn-secondary mb-1">오바드야서</button>
            <button disabled id="btn-39" type="button" class="btn btn-secondary mb-1">요나서</button>
            <button disabled id="btn-40" type="button" class="btn btn-secondary mb-1">미카서</button>
            <button disabled id="btn-41" type="button" class="btn btn-secondary mb-1">나훔서</button>
            <button disabled id="btn-42" type="button" class="btn btn-secondary mb-1">하바쿡서</button>
            <button disabled id="btn-43" type="button" class="btn btn-secondary mb-1">스바니야서</button>
            <button disabled id="btn-44" type="button" class="btn btn-secondary mb-1">하까이서</button>
            <button disabled id="btn-45" type="button" class="btn btn-secondary mb-1">즈카르야서</button>
            <button disabled id="btn-46" type="button" class="btn btn-secondary mb-1">말라키서</button>
            <button disabled id="btn-47" type="button" class="btn btn-secondary mb-1">마태오 복음서</button>
            <button disabled id="btn-48" type="button" class="btn btn-secondary mb-1">마르코 복음서</button>
            <button disabled id="btn-49" type="button" class="btn btn-secondary mb-1">루카 복음서</button>
            <button disabled id="btn-50" type="button" class="btn btn-secondary mb-1">요한 복음서</button>
            <button disabled id="btn-51" type="button" class="btn btn-secondary mb-1">사도행전</button>
            <button disabled id="btn-52" type="button" class="btn btn-secondary mb-1">로마</button>
            <button disabled id="btn-53" type="button" class="btn btn-secondary mb-1">코린토 1</button>
            <button disabled id="btn-54" type="button" class="btn btn-secondary mb-1">코린토 2</button>
            <button disabled id="btn-55" type="button" class="btn btn-secondary mb-1">갈라티아</button>
            <button disabled id="btn-56" type="button" class="btn btn-secondary mb-1">에페소</button>
            <button disabled id="btn-57" type="button" class="btn btn-secondary mb-1">필리피</button>
            <button disabled id="btn-58" type="button" class="btn btn-secondary mb-1">콜로새</button>
            <button disabled id="btn-59" type="button" class="btn btn-secondary mb-1">테살로니카 1</button>
            <button disabled id="btn-60" type="button" class="btn btn-secondary mb-1">테살로니카 2</button>
            <button disabled id="btn-61" type="button" class="btn btn-secondary mb-1">티모테오 1</button>
            <button disabled id="btn-62" type="button" class="btn btn-secondary mb-1">티모테오 2</button>
            <button disabled id="btn-63" type="button" class="btn btn-secondary mb-1">티토</button>
            <button disabled id="btn-64" type="button" class="btn btn-secondary mb-1">필레몬</button>
            <button disabled id="btn-65" type="button" class="btn btn-secondary mb-1">히브리인들</button>
            <button disabled id="btn-66" type="button" class="btn btn-secondary mb-1">야고보</button>
            <button disabled id="btn-67" type="button" class="btn btn-secondary mb-1">베드로 1</button>
            <button disabled id="btn-68" type="button" class="btn btn-secondary mb-1">베드로 2</button>
            <button disabled id="btn-69" type="button" class="btn btn-secondary mb-1">요한 1</button>
            <button disabled id="btn-70" type="button" class="btn btn-secondary mb-1">요한 2</button>
            <button disabled id="btn-71" type="button" class="btn btn-secondary mb-1">요한 3</button>
            <button disabled id="btn-72" type="button" class="btn btn-secondary mb-1">유다</button>
            <button disabled id="btn-73" type="button" class="btn btn-secondary mb-1">요한 묵시록</button>

        
        </div>
       </div>
       
      </div>
      </div>
    
</body>
</html>

<script>
    var lastSelectedItem = "";


// Array of strings from above comment
const books = [
    "창세기", 
    "탈출기", 
    "레위기", 
    "민수기", 
    "신명기", 
    "여호수아기", 
    "판관기", 
    "룻기",
    "사무엘기 상권", 
    "사무엘기 하권", 
    "열왕기 상권", 
    "열왕기 하권", 
    "역대기 상권", 
    "역대기 하권", 
    "에즈라기", 
    "느헤미야기", 
    "토빗기", 
    "유딧기", 
    "에스테르기", 
    "마카베오기 상권", 
    "마카베오기 하권", 
    "욥기", 
    "시편",
    "잠언", 
    "코헬렛", 
    "아가",
    "지혜서", 
    "집회서", 
    "이사야서", 
    "예레미야서", 
    "애가",
    "바룩서",
    "에제키엘서", 
    "다니엘서", 
    "호세아서", 
    "요엘서",
    "아모스서",
    "오바드야서",
    "요나서",
    "미카서",
    "나훔서",
    "하바쿡서",
    "스바니야서",
    "하까이서",
    "즈카르야서", 
    "말라키서",
    "마태오 복음서", 
    "마르코 복음서", 
    "루카 복음서", 
    "요한 복음서", 
    "사도행전", 
    "로마",
    "코린토 1",
    "코린토 2",
    "갈라티아 ",
    "에페소",
    "필리피",
    "콜로새",
    "테살로니카 1",
    "테살로니카 2",
    "티모테오 1",
    "티모테오 2",
    "티토",
    "필레몬",
    "히브리인들",
    "야고보",
    "베드로 1",
    "베드로 2",
    "요한 1",
    "요한 2",
    "요한 3",
    "유다",
    "요한 묵시록"
];

const sectors = books.map((n, i) => ({
    color: `hsl(${i * 360 / 75}, 70%, 80%)`,
    label: n
}));

// Generate random float in range min-max:
const rand = (m, M) => Math.random() * (M - m) + m;
var tot = sectors.length;
const elSpin = document.querySelector("#spin");
const ctx = document.querySelector("#wheel").getContext`2d`;
const dia = ctx.canvas.width;
const rad = dia / 2;
const PI = Math.PI;
const TAU = 2 * PI;
var arc = TAU / tot;
const friction = 0.991;  // 0.995=soft, 0.99=mid, 0.98=hard
var angVelMin = 0.002; // Below that number will be treated as a stop
// const angVelMin = 10.1; // Below that number will be treated as a stop
let angVelMax = 0; // Random ang.vel. to accelerate to 
let angVel = 0;    // Current angular velocity
let ang = 0;       // Angle rotation in radians
let isSpinning = false;
let isAccelerating = false;
let animFrame = null; // Engine's requestAnimationFrame

//* Get index of current sector */
var getIndex = () => Math.floor(tot - ang / TAU * tot) % tot;

//* Draw sectors and prizes texts to canvas */
const drawSector = (sector, i) => {
  const ang = arc * i;
  ctx.save();
  // COLOR
  ctx.beginPath();
  ctx.fillStyle = sector.color;
  ctx.moveTo(rad, rad);
  ctx.arc(rad, rad, rad, ang, ang + arc);
  ctx.lineTo(rad, rad);
  ctx.fill();
  // TEXT
  ctx.translate(rad, rad);
  ctx.rotate(ang + arc / 2);
  ctx.textAlign = "right";
  ctx.fillStyle = "#000";
  ctx.font = "bold 20px sans-serif";
  ctx.fillText(sector.label, rad - 10, 10);
  //
  ctx.restore();
};

//* CSS rotate CANVAS Element */
const rotate = () => {
  const sector = sectors[getIndex()];
  ctx.canvas.style.transform = `rotate(${ang - PI / 2}rad)`;
  elSpin.textContent = sector.label;
  elSpin.style.background = sector.color;

  if (angVel == 0) {
    // Set lastSelectedNumber
    lastSelectedItem = sector.label;
    // find index of lastSelectedItem in books
    var index = books.indexOf(lastSelectedItem) + 1;

    document.getElementById("btn-" + index).disabled = false;
    document.getElementById("btn-" + index).classList.remove("btn-secondary");
    document.getElementById("btn-" + index).classList.add("btn-primary");
  }
};

const frame = () => {

  if (!isSpinning) return;

  if (angVel >= angVelMax) isAccelerating = false;

  // Accelerate
  if (isAccelerating) {
    angVel ||= angVelMin; // Initial velocity kick
    angVel *= 1.06; // Accelerate
  }
  
  // Decelerate
  else {
    isAccelerating = false;
    angVel *= friction; // Decelerate by friction  

    // SPIN END:
    if (angVel < angVelMin) {
      isSpinning = false;
      angVel = 0;
      cancelAnimationFrame(animFrame);
    }
  }

  ang += angVel; // Update angle
  ang %= TAU;    // Normalize angle
  rotate();      // CSS rotate!
};

const engine = () => {
  frame();
  animFrame = requestAnimationFrame(engine)
};

elSpin.addEventListener("click", () => {
  if (isSpinning) return;
  if (lastSelectedItem != "") {
 // Remove selected sector
 sectors.splice(getIndex(), 1);

// remove all sectors
ctx.clearRect(0, 0, dia, dia);
tot = sectors.length;
arc = TAU / tot;
// Draw remaining sectors
sectors.forEach(drawSector);
  }
 

  isSpinning = true;
  isAccelerating = true;
  angVelMax = rand(0.25, 0.40);
  angVelMin = rand(0.0005, 0.002)
  // angVelMin = 111;
  engine(); // Start engine!
});

// INIT!
sectors.forEach(drawSector);
// rotate(); // Initial rotation
</script>